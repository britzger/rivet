\documentclass{JHEP3}
%\JHEP{00(2007)000}

\usepackage{xspace,graphicx,mparhack,amsmath,amssymb,url,underscore,fancyvrb}
%\usepackage{dropping}

\newenvironment{snippet}{\Verbatim}{\endVerbatim}

\newcommand{\kbd}[1]{\texttt{#1}\xspace}
\newcommand{\inp}[1]{\textsf{\textdollar}\hspace{1mm}\texttt{#1}\xspace}
\newcommand{\outp}[1]{\textsf{#1}\xspace}
\newcommand{\code}[1]{\texttt{#1}\xspace}
\newcommand{\var}[1]{\texttt{\textdollar{}#1}\xspace}
\newcommand{\val}[1]{\textit{\ensuremath{\langle\text{\textrm{#1}\/}\rangle}}\xspace}
\newcommand{\home}{\texttt{\ensuremath{\sim}}\xspace}

\let\oldmarginpar\marginpar
\renewcommand\marginpar[1]{\-\oldmarginpar{\footnotesize \textit{#1}}}
%\renewcommand\marginpar[1]{\-\oldmarginpar[\raggedleft\footnotesize \textit{#1}]%
%{\raggedright\footnotesize \textit{#1}}}

\newcommand{\bendimg}{\includegraphics[height=1cm]{bend}}
\newcommand{\dblbendimg}{\bendimg\hspace{0.5mm}\bendimg}
\newenvironment{bend}{\bendimg}{\ignorespacesafterend}
\newenvironment{dblbend}{\dblbendimg}{\ignorespaceafterend}

\title{Rivet and AGILe manual}

\author{Andy Buckley\\ IPPP, Durham University, UK.\\ E-mail: \email{andy.buckley@durham.ac.uk}}
\author{James Monk\\ HEP Group, Dept. of Physics and Astronomy, UCL, London, UK.\\ E-mail: \email{jmonk@fnal.gov}}
\author{Lars Sonnenschein\\ CERN, Gen\`eve 1206, Switzerland.\\ E-mail: \email{sonne@cern.ch}}
\author{Jon Butterworth\\ HEP Group, Dept. of Physics and Astronomy, UCL, London, UK.\\ E-mail: \email{jmb@hep.ucl.ac.uk}}
\author{Leif L\"onnblad\\ Theoretical Physics, Lund University, Sweden.\\ E-mail: \email{lonnblad@thep.lu.se}}

\preprint{}
%\preprint{\hepth{9912999}}

\abstract{This document is the manual and user guide for the Rivet system for
  the validation and tuning of Monte Carlo event generators. As well as the core
  Rivet library, this manual describes the usage of the \kbd{rivetgun} program
  and the AGILe generator interface library. The level of description is
  generally intended for users of the system, starting with the basics of using
  validation code written by others, and then covering all the details you need
  to know to write your own Rivet components.}

\keywords{Event generator, simulation, validation, tuning, QCD}


\begin{document} 


\section{Introduction}
This manual is a users' guide to using the Rivet generator validation
system. Rivet itself is a C++ class library, with classes to represent
observable calculations, analyses and their data objects, and a collection of
infrastructure/management objects which you hopefully won't have to worry about
very much. The simplest way to use Rivet is via the \kbd{rivetgun} command line
tool, which can run a generator using the AGILe interface library, analyse the
events as they are generated, and produce output distributions in your format of
choice. For those who wish to embed their analyses in some larger framework,
Rivet can also be run programmatically on HepMC event objects with no special
executable being required.

Before we get started, a declaration of intent: this manual is intended to be a
guide to using Rivet, \emph{not} a comprehensive and painstakingly maintained
reference to the application programming interface (API) of the Rivet and AGILe
libraries. For that purpose, you will hopefully find the online generated
documentation at \url{http://projects.hepforge.org/rivet} and
\url{http://projects.hepforge.org/agile} to be ideal.

\subsection{Typographic conventions}
As is normal in computer user manuals, the typography in this manual is used to
indicate whether we are describing source code elements, commands to be run in a
terminal, the output of a command etc.

The main such clue will be the use of \kbd{typewriter-style} text: this
indicates the name of a command or code element --- class names, function names
etc. Typewriter font is also used for commands to be run in a terminal, but in
this case it will be prefixed by a dollar sign, as in \inp{echo ''Hello'' |
  cat}.  The output of such a command on the terminal will be typeset in
\outp{sans-serif} font. When we are documenting a code feature in detail (which
is not the main point of this manual), we will use square brackets to indicate
optional arguments, and italic font between angle brackets to represent an
argument name which should be replaced by a value,
e.g. \code{Event::applyProjection(\val{proj})}.

Following the example of Donald Knuth in his books on \TeX{}, in this document
we will indicate paragraphs of particular technicality or esoteric nature with a
``dangerous bend''\marginpar{\bendimg\\Dangerous bend} sign. These will typically be about the
internals of Rivet which most people will be lucky enough never to need know
about, but for detail obsessives, the inordinately curious and Rivet hackers
they may be useful. You can almost certainly skip them on a first
reading. Similarly, you may see double bend signs
\marginpar{\dblbendimg\\Double bend} --- the same rules apply for
these, but even more strongly.


\section{Quickstart}
The point of this section is to get you up and running with Rivet as soon as
possible. Doing this by hand may be rather frustrating, as Rivet depends on
several external libraries --- you'll get bored downloading and building them by
hand in the right order. To make life more pleasant, we have written a
bootstrapping script which will download tarballs of Rivet, AGILe and the other
required libraries, expand them and build them in the right order. You can get
this script from the following Web address:
\url{http://www.hepforge.org/downloads/rivet/rivet-bootstrap}

To run the script, we recommend that you choose a personal installation
directory. Personally, I make a \kbd{\home/local} directory for this purpose, to
avoid polluting my home directory with a lot of files. If you already use a
directory of the same name, you might want to use a separate one, say
\kbd{\home/rivetlocal}. You'll need to add \kbd{\val{localdir}/bin} to your
\var{PATH} environment variable and \kbd{\val{localdir}/lib} to your
\var{LD_LIBRARY_PATH}.

Now, change directory to your build area (you may also want to make this,
e.g. \kbd{\home/build}), and download the script:\\
\inp{wget \url{http://www.hepforge.org/downloads/rivet/rivet-bootstrap}}\\
Now run it, specifying the install area as the argument:\\
\inp{chmod a+x rivet-bootstrap}\\
\inp{./rivet-bootstrap \val{localdir}}\\

\section{Running \kbd{rivetgun}}

\begin{bend}
This section is super-hardcore
\end{bend}

\section{The projection/analysis model}
\subsection{How projection caching works (skippable, but useful as a reference)}
\section{Analysis histo autobinning}
\section{Pluggable analyses}
\section{Standard projection summary}
\section{Example projection}
\section{Example analysis}
\section{Viewing output data files}
\section{Comparing with reference data (qualitative)}


% \begin{thebibliography}{999}
% \end{thebibliography}

\end{document}
